---
import { authService } from '../../lib/supabase';
import '../../styles/admin-header.css';
---

<header class="dashboard-header mobile-only">
  <div class="dashboard-header-left">
    <h1 class="dashboard-title">Dashboard</h1>
    <p class="dashboard-subtitle">Bem-vindo(a) ao painel administrativo</p>
  </div>

  <button
    type="button"
    id="logout-btn"
    class="logout-btn"
    aria-label="Sair da conta"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
      ></path>
    </svg>
    Sair
  </button>

  <script>
    import { authService } from '../../lib/supabase';

    document.addEventListener('DOMContentLoaded', () => {
      const logoutBtn = document.getElementById('logout-btn');
      logoutBtn?.addEventListener('click', async () => {
        if (confirm('Tem certeza que deseja sair?')) {
          try {
            await authService.signOut();

            await fetch('/api/admin/auth/logout', {
              method: 'POST',
              credentials: 'include',
            });

            window.location.href = '/admin/login';
          } catch (error) {
            console.error('Erro ao sair:', error);
            window.location.href = '/admin/login';
          }
        }
      });
    });
  </script>
</header>
