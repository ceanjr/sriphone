---
import AdminLayout from '../../../layouts/AdminLayout.astro';
import { supabaseAdmin } from '../../../lib/supabaseAdmin';
import '../../../styles/admin-form.css';

export const prerender = false;

const { data: categorias } = await supabaseAdmin
  .from('categorias')
  .select('*')
  .order('nome');
---

<AdminLayout
  title="Novo Produto"
  description="Adicionar novo produto ao cat√°logo"
>
  <div class="form-page">
    <div class="form-container">
      <div class="form-header">
        <a href="/admin/produtos" class="form-back-btn">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 19l-7-7 7-7"></path>
          </svg>
          Voltar para Produtos
        </a>
        <h1 class="form-title">Novo Produto</h1>
        <p class="form-subtitle">Preencha as informa√ß√µes do produto</p>
      </div>

      <div class="form-card">
        <form id="product-form">
          <!-- Image Upload -->
          <div class="form-group">
            <label class="form-label">Imagens do Produto (at√© 5)</label>
            <input
              id="foto-upload"
              type="file"
              accept="image/*"
              multiple
              style="display: none;"
            />
            <div class="form-image-upload" id="upload-area">
              <div class="upload-placeholder">
                <svg
                  width="48"
                  height="48"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                  ></path>
                </svg>
                <p>Clique para adicionar imagens</p>
                <small>JPG, PNG at√© 10MB cada (m√°ximo 5 imagens)</small>
              </div>
            </div>
          </div>

          <!-- Nome -->
          <div class="form-group">
            <label class="form-label" for="nome">
              Nome do Produto
              <span class="form-label-required">*</span>
            </label>
            <input
              id="nome"
              name="nome"
              type="text"
              class="form-input"
              placeholder="Ex: iPhone 13 Pro Max 256GB"
              required
            />
          </div>

          <!-- C√≥digo e Pre√ßo -->
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="codigo">C√≥digo</label>
              <input
                id="codigo"
                name="codigo"
                type="text"
                class="form-input"
                placeholder="Ex: IP13PM256"
              />
            </div>
            <div class="form-group">
              <label class="form-label" for="preco">
                Pre√ßo
                <span class="form-label-required">*</span>
              </label>
              <input
                id="preco"
                name="preco"
                type="number"
                step="0.01"
                class="form-input"
                placeholder="0.00"
                required
              />
            </div>
          </div>

          <!-- Categoria e Condi√ß√£o -->
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="categoria_id">
                Categoria
                <span class="form-label-required">*</span>
              </label>
              <select
                id="categoria_id"
                name="categoria_id"
                class="form-select"
                required
              >
                <option value="">Selecione uma categoria</option>
                {
                  categorias?.map((categoria) => (
                    <option value={categoria.id}>{categoria.nome}</option>
                  ))
                }
              </select>
            </div>
            <div class="form-group">
              <label class="form-label" for="condicao">Condi√ß√£o</label>
              <select id="condicao" name="condicao" class="form-select">
                <option value="Novo">Novo</option>
                <option value="Seminovo">Seminovo</option>
              </select>
            </div>
          </div>

          <!-- Bateria -->
          <div class="form-group">
            <label class="form-label" for="bateria">Bateria (mAh)</label>
            <input
              id="bateria"
              name="bateria"
              type="number"
              class="form-input"
              placeholder="Ex: 4352"
            />
          </div>

          <!-- Descri√ß√£o -->
          <div class="form-group">
            <label class="form-label" for="descricao">Descri√ß√£o</label>
            <textarea
              id="descricao"
              name="descricao"
              class="form-textarea"
              placeholder="Descreva o produto, suas caracter√≠sticas e estado..."
            ></textarea>
          </div>

          <!-- Actions -->
          <div class="form-actions">
            <a href="/admin/produtos" class="form-btn form-btn-cancel"
              >Cancelar</a
            >
            <button
              type="submit"
              id="submit-btn"
              class="form-btn form-btn-submit"
            >
              <span id="submit-text">Adicionar Produto</span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</AdminLayout>

<script>
  // ============================================================================
  // SISTEMA DE UPLOAD IMEDIATO - Upload acontece ao adicionar cada imagem
  // ============================================================================

  console.log('‚úÖ [NOVO PRODUTO] Script iniciado');

  const form = document.getElementById('product-form') as HTMLFormElement;
  const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement;
  const submitText = document.getElementById('submit-text') as HTMLSpanElement;
  const fileInput = document.getElementById('foto-upload') as HTMLInputElement;
  const uploadArea = document.getElementById('upload-area');

  const MAX_IMAGES = 5;
  const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB

  // Interface para imagem com estado de upload
  interface ImageItem {
    id: string;           // ID √∫nico para cada imagem
    file: File;           // Arquivo original
    previewUrl: string;   // Blob URL para preview local
    serverUrl: string | null;  // URL do servidor ap√≥s upload
    status: 'uploading' | 'success' | 'error';
  }

  // Array de imagens com estado
  let images: ImageItem[] = [];

  // Estado do formul√°rio
  let formDirty = false;
  let isSubmitting = false;

  // Gerar ID √∫nico
  function generateId(): string {
    return `img_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }

  // ============================================================================
  // FUN√á√ÉO DE UPLOAD IMEDIATO
  // ============================================================================

  async function uploadImageToStorage(file: File): Promise<string | null> {
    console.log(`üì§ [UPLOAD] Enviando: ${file.name}`);

    const formData = new FormData();
    formData.append('file', file);

    const response = await fetch('/api/admin/upload', {
      method: 'POST',
      body: formData,
    });

    if (!response.ok) {
      const error = await response.json();
      throw new Error(error.error || 'Erro no upload');
    }

    const result = await response.json();
    console.log(`‚úÖ [UPLOAD] Sucesso: ${result.url}`);

    return result.url;
  }

  // ============================================================================
  // ADICIONAR IMAGEM COM UPLOAD IMEDIATO
  // ============================================================================

  async function addImageWithUpload(file: File): Promise<void> {
    const id = generateId();
    const previewUrl = URL.createObjectURL(file);

    // Adicionar imagem com status "uploading"
    const imageItem: ImageItem = {
      id,
      file,
      previewUrl,
      serverUrl: null,
      status: 'uploading'
    };

    images.push(imageItem);
    renderPreviews();

    // Fazer upload
    try {
      const serverUrl = await uploadImageToStorage(file);

      // Encontrar a imagem e atualizar status
      const img = images.find(i => i.id === id);
      if (img) {
        if (serverUrl) {
          img.serverUrl = serverUrl;
          img.status = 'success';
          console.log(`‚úÖ [UPLOAD] Imagem ${file.name} enviada com sucesso`);
        } else {
          img.status = 'error';
          window.showToast(`Erro ao enviar ${file.name}`, 'error');
        }
      }
    } catch (error: any) {
      console.error(`‚ùå [UPLOAD] Erro:`, error);
      const img = images.find(i => i.id === id);
      if (img) {
        img.status = 'error';
      }
      window.showToast(`Erro ao enviar ${file.name}`, 'error');
    }

    renderPreviews();
  }

  // ============================================================================
  // RENDERIZA√á√ÉO COM ESTADOS DE UPLOAD
  // ============================================================================

  function renderPreviews() {
    if (!uploadArea) return;

    console.log(`üñºÔ∏è [PREVIEW] Renderizando ${images.length} imagens`);

    if (images.length === 0) {
      uploadArea.innerHTML = `
        <div class="upload-placeholder">
          <svg width="48" height="48" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z">
            </path>
          </svg>
          <p>Clique para adicionar imagens</p>
          <small>JPG, PNG at√© 10MB cada (m√°ximo 5 imagens)</small>
        </div>
      `;
      return;
    }

    const imagesHTML = images
      .map((img, index) => {
        const isMain = index === 0;
        const isUploading = img.status === 'uploading';
        const isError = img.status === 'error';
        const isSuccess = img.status === 'success';

        // Usar URL do servidor se dispon√≠vel, sen√£o preview local
        const displayUrl = img.serverUrl || img.previewUrl;

        let borderColor = isMain ? '#3b82f6' : '#e5e7eb';
        if (isUploading) borderColor = '#f59e0b'; // amarelo
        if (isError) borderColor = '#ef4444'; // vermelho

        let statusBadge = '';
        if (isUploading) {
          statusBadge = `
            <div style="position: absolute; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 5;">
              <div style="width: 24px; height: 24px; border: 3px solid #fff; border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite;"></div>
            </div>
          `;
        } else if (isError) {
          statusBadge = `
            <div style="position: absolute; inset: 0; background: rgba(239,68,68,0.7); display: flex; align-items: center; justify-content: center; z-index: 5;">
              <span style="color: white; font-size: 24px;">‚úï</span>
            </div>
          `;
        } else if (isSuccess) {
          statusBadge = `
            <div style="position: absolute; top: 6px; left: 6px; background: rgba(34, 197, 94, 0.95); color: white; width: 20px; height: 20px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; z-index: 5;">‚úì</div>
          `;
        }

        return `
          <div style="position: relative; aspect-ratio: 1 / 1; border-radius: 8px; overflow: hidden; border: 2px solid ${borderColor}; background: #1a1a1a; cursor: ${isMain || isUploading ? 'default' : 'pointer'}; transition: all 0.2s;"
            onclick="${isMain || isUploading ? '' : `event.stopPropagation(); window.setMainImage(${index})`}"
            data-image-id="${img.id}"
          >
            <img
              src="${displayUrl}"
              alt="${img.file.name}"
              style="width: 100%; height: 100%; object-fit: cover; object-position: center; display: block; ${isUploading ? 'opacity: 0.5;' : ''}"
              loading="eager"
            />
            ${statusBadge}
            ${!isUploading ? `
              <button
                type="button"
                onclick="event.stopPropagation(); event.preventDefault(); window.removeImageById('${img.id}')"
                style="position: absolute; top: 6px; right: 6px; background: rgba(239, 68, 68, 0.9); color: white; border: none; border-radius: 50%; min-width: 20px; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 14px; font-weight: bold; line-height: 1; padding: 0; transition: all 0.2s; z-index: 10;"
                title="Remover imagem"
              >√ó</button>
            ` : ''}
            ${isMain && isSuccess ? '<span style="position: absolute; bottom: 6px; left: 6px; background: rgba(59, 130, 246, 0.95); color: white; font-size: 10px; padding: 3px 8px; border-radius: 4px; font-weight: 600; z-index: 5;">Principal</span>' : ''}
          </div>
        `;
      })
      .join('');

    const canAddMore = images.length < MAX_IMAGES && !images.some(i => i.status === 'uploading');
    const addButtonHTML = canAddMore
      ? `
          <div style="aspect-ratio: 1 / 1; border-radius: 8px; border: 2px dashed #d1d5db; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; background: #0A0A0A; transition: all 0.2s;"
            onmouseover="this.style.borderColor='#f9fafb'; this.style.background='#121212'"
            onmouseout="this.style.borderColor='#d1d5db'; this.style.background='#0A0A0A'"
          >
            <svg style="width: 32px; height: 32px; color: #f9fafb; margin-bottom: 6px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
            </svg>
            <span style="font-size: 12px; color: #f9fafb; font-weight: 500;">Adicionar</span>
          </div>
        `
      : '';

    uploadArea.innerHTML = `
      <style>
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      </style>
      <div class="images-preview-grid">
        ${imagesHTML}
        ${addButtonHTML}
      </div>
    `;
  }

  // ============================================================================
  // HANDLERS
  // ============================================================================

  (window as any).removeImageById = (id: string) => {
    const img = images.find(i => i.id === id);
    if (img) {
      console.log(`üóëÔ∏è [PREVIEW] Removendo imagem: ${img.file.name}`);
      URL.revokeObjectURL(img.previewUrl);
      images = images.filter(i => i.id !== id);
      renderPreviews();
      window.showToast('Imagem removida', 'success');
    }
  };

  (window as any).setMainImage = (index: number) => {
    if (index === 0) return;
    const img = images[index];
    if (img && img.status !== 'uploading') {
      console.log(`‚≠ê [PREVIEW] Tornando imagem principal: ${img.file.name}`);
      images.splice(index, 1);
      images.unshift(img);
      renderPreviews();
      window.showToast('Imagem principal alterada', 'success');
    }
  };

  uploadArea?.addEventListener('click', (e) => {
    const target = e.target as HTMLElement;
    if (target.closest('button')) return;

    const hasUploading = images.some(i => i.status === 'uploading');
    if (hasUploading) {
      window.showToast('Aguarde o upload em andamento...', 'warning');
      return;
    }

    if (images.length < MAX_IMAGES) {
      fileInput?.click();
    } else {
      window.showToast(`M√°ximo de ${MAX_IMAGES} imagens`, 'warning');
    }
  });

  fileInput?.addEventListener('change', async (e) => {
    const files = (e.target as HTMLInputElement).files;
    if (!files || files.length === 0) return;

    const remainingSlots = MAX_IMAGES - images.length;
    const filesToAdd = Array.from(files).slice(0, remainingSlots);

    // DEBUG: Mostrar quantos arquivos foram selecionados
    window.showToast(`Processando ${filesToAdd.length} imagem(ns)...`, 'info');

    // Processar cada arquivo SEQUENCIALMENTE
    for (let i = 0; i < filesToAdd.length; i++) {
      const file = filesToAdd[i];

      // Validar tamanho
      if (file.size > MAX_FILE_SIZE) {
        window.showToast(`${file.name} √© muito grande (m√°x 10MB)`, 'error');
        continue;
      }

      // Validar tipo
      if (!file.type.startsWith('image/')) {
        window.showToast(`${file.name} n√£o √© uma imagem`, 'error');
        continue;
      }

      // DEBUG: Mostrar qual imagem est√° sendo processada
      window.showToast(`Enviando imagem ${i + 1}/${filesToAdd.length}...`, 'info');

      // Upload imediato (aguarda cada um terminar antes do pr√≥ximo)
      await addImageWithUpload(file);

      // DEBUG: Confirmar que o upload terminou
      window.showToast(`Imagem ${i + 1} enviada!`, 'success');
    }

    // Limpar input
    fileInput.value = '';
  });

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();

    // Verificar se h√° imagens
    if (images.length === 0) {
      window.showToast('Adicione pelo menos uma imagem', 'warning');
      return;
    }

    // Verificar se h√° uploads em andamento
    const hasUploading = images.some(i => i.status === 'uploading');
    if (hasUploading) {
      window.showToast('Aguarde o upload das imagens terminar', 'warning');
      return;
    }

    // Verificar se h√° erros de upload
    const hasErrors = images.some(i => i.status === 'error');
    if (hasErrors) {
      window.showToast('Remova as imagens com erro antes de salvar', 'warning');
      return;
    }

    // Pegar apenas URLs de imagens com upload bem-sucedido
    const validUrls = images
      .filter(i => i.status === 'success' && i.serverUrl)
      .map(i => i.serverUrl as string);

    if (validUrls.length === 0) {
      window.showToast('Nenhuma imagem foi enviada com sucesso', 'error');
      return;
    }

    // Marcar que estamos no processo de submit
    isSubmitting = true;
    submitBtn.disabled = true;
    submitText.innerHTML = '<div class="form-spinner"></div> Salvando...';

    try {
      console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');
      console.log('üíæ [SUBMIT] Salvando produto com imagens j√° uploadadas');
      console.log(`üì∏ [SUBMIT] ${validUrls.length} imagens prontas`);

      // Coletar dados do formul√°rio
      const formData = new FormData(form);
      const produto = {
        nome: formData.get('nome'),
        codigo: formData.get('codigo') || null,
        preco: parseFloat(formData.get('preco') as string),
        bateria: formData.get('bateria')
          ? parseInt(formData.get('bateria') as string)
          : null,
        condicao: formData.get('condicao'),
        categoria_id: formData.get('categoria_id'),
        descricao: formData.get('descricao') || null,
        imagens: validUrls,
      };

      console.log('üì¶ [SUBMIT] Dados do produto:', produto);

      // Salvar produto
      const response = await fetch('/api/admin/produtos', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(produto),
      });

      if (!response.ok) {
        const error = await response.json();
        throw new Error(error.error || 'Erro ao salvar produto');
      }

      console.log('‚úÖ [SUBMIT] Produto salvo com sucesso!');
      console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');

      window.showToast('Produto adicionado com sucesso!', 'success');

      setTimeout(() => {
        const timestamp = new Date().getTime();
        window.location.href = `/admin/produtos?_t=${timestamp}`;
      }, 1000);
    } catch (error: any) {
      console.error('‚ùå [SUBMIT] Erro:', error);
      window.showToast(error.message || 'Erro ao salvar produto', 'error');
      isSubmitting = false;
    } finally {
      submitBtn.disabled = false;
      submitText.textContent = 'Adicionar Produto';
    }
  });

  // ============================================================================
  // PROTE√á√ÉO CONTRA RELOAD ACIDENTAL
  // ============================================================================

  // Marcar formul√°rio como "sujo" quando usu√°rio faz mudan√ßas
  form?.addEventListener('input', () => {
    formDirty = true;
  });

  // Avisar antes de sair se houver mudan√ßas n√£o salvas
  window.addEventListener('beforeunload', (e) => {
    // S√≥ avisar se:
    // 1. Formul√°rio foi modificado OU tem imagens
    // 2. N√ÉO est√° no processo de submit
    if ((formDirty || images.length > 0) && !isSubmitting) {
      e.preventDefault();
      // Chrome requires returnValue to be set
      e.returnValue = 'Voc√™ tem altera√ß√µes n√£o salvas. Deseja realmente sair?';
      return e.returnValue;
    }
  });

  // Prevenir navega√ß√£o acidental via service worker ou outros eventos
  let controllerChangeCount = 0;
  if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
    navigator.serviceWorker.addEventListener('controllerchange', () => {
      controllerChangeCount++;
      console.log(`[SW] Controller mudou (${controllerChangeCount}x)`);

      // Se mudou mais de uma vez E o usu√°rio est√° preenchendo o form, avisar
      if (
        controllerChangeCount > 1 &&
        (formDirty || images.length > 0) &&
        !isSubmitting
      ) {
        console.warn(
          '[SW] Service Worker atualizou mas N√ÉO vamos recarregar (formul√°rio em uso)'
        );
      }
    });
  }

  // Fun√ß√£o para limpar blob URLs e evitar memory leaks
  function cleanupBlobUrls() {
    images.forEach(img => {
      if (img.previewUrl && img.previewUrl.startsWith('blob:')) {
        URL.revokeObjectURL(img.previewUrl);
      }
    });
  }

  // Limpar blob URLs quando sair da p√°gina
  window.addEventListener('pagehide', cleanupBlobUrls);

  // Renderizar estado inicial
  renderPreviews();
</script>

<style>
  .upload-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 48px 24px;
    text-align: center;
    cursor: pointer;
  }

  .upload-placeholder svg {
    color: #9ca3af;
    margin-bottom: 16px;
  }

  .upload-placeholder p {
    font-size: 14px;
    font-weight: 500;
    color: #6b7280;
    margin-bottom: 4px;
  }

  .upload-placeholder small {
    font-size: 12px;
    color: #9ca3af;
  }
</style>

<style is:global>
  /* For√ßar display block no container quando h√° grid */
  #upload-area:has(.images-preview-grid),
  .form-image-upload:has(.images-preview-grid) {
    display: block !important;
    min-height: auto !important;
    padding: 0 !important;
  }

  .images-preview-grid {
    display: grid !important;
    grid-template-columns: repeat(3, 1fr) !important;
    gap: 12px;
    padding: 16px;
  }

  @media (min-width: 768px) {
    .images-preview-grid {
      grid-template-columns: repeat(5, 1fr) !important;
    }
  }
</style>

<style>
  .images-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 12px;
    padding: 16px;
  }

  .image-preview-item {
    position: relative;
    aspect-ratio: 1;
    border-radius: 8px;
    overflow: hidden;
    border: 2px solid #e5e7eb;
    background: #f9fafb;
  }

  .image-preview-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .image-remove-btn {
    position: absolute;
    top: 4px;
    right: 4px;
    background: rgba(239, 68, 68, 0.9);
    color: white;
    border: none;
    border-radius: 50%;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 18px;
    font-weight: bold;
    transition: all 0.2s;
  }

  .image-remove-btn:hover {
    background: rgba(220, 38, 38, 1);
    transform: scale(1.1);
  }

  .image-principal-badge {
    position: absolute;
    bottom: 6px;
    left: 6px;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    font-size: 11px;
    padding: 4px 8px;
    border-radius: 4px;
    font-weight: 500;
  }

  .image-add-btn {
    aspect-ratio: 1;
    border-radius: 8px;
    border: 2px dashed #d1d5db;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    background: #f9fafb;
    transition: all 0.2s;
  }

  .image-add-btn:hover {
    border-color: #9ca3af;
    background: #f3f4f6;
  }

  .image-add-btn svg {
    color: #9ca3af;
    margin-bottom: 4px;
  }

  .image-add-btn span {
    font-size: 12px;
    color: #6b7280;
    font-weight: 500;
  }
</style>
