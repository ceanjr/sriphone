---
export const prerender = false;
---

<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Teste de Imports</title>
  <style>
    body {
      background: #000;
      color: #0f0;
      font-family: monospace;
      padding: 2rem;
      line-height: 1.6;
    }
    .pass { color: #0f0; }
    .fail { color: #f00; }
    .pending { color: #ff0; }
  </style>
</head>
<body>
  <h1>üß™ TESTE DE IMPORTS DO CAT√ÅLOGO</h1>
  <p>Testando cada m√≥dulo individualmente...</p>
  <div id="output"></div>
</body>
</html>

<script>
  const output = document.getElementById('output');

  function log(message, status = 'pending') {
    const p = document.createElement('p');
    p.className = status;
    p.textContent = message;
    if (output) output.appendChild(p);
    console.log(message);
  }

  async function testImports() {
    log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'pending');
    log('üîç Iniciando teste de imports...', 'pending');
    log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'pending');

    const imports = [
      { name: 'authService', path: '../lib/supabase', extract: (m) => m.authService },
      { name: 'state', path: '../lib/catalog/core/state', extract: (m) => m.initState },
      { name: 'config', path: '../lib/catalog/core/config', extract: (m) => m.CATALOG_CONFIG },
      { name: 'logic', path: '../lib/catalog/logic', extract: (m) => m.filtrarProdutos },
      { name: 'renderer', path: '../lib/catalog/render/renderer', extract: (m) => m.renderer },
      { name: 'templates', path: '../lib/catalog/render/templates', extract: (m) => m.templates },
      { name: 'handlers', path: '../lib/catalog/ui/handlers', extract: (m) => m.createHandlers },
      { name: 'events', path: '../lib/catalog/ui/events', extract: (m) => m.catalogEvents },
      { name: 'imageLoader', path: '../lib/catalog/performance/imageLoader', extract: (m) => m.imageLoader },
      { name: 'metrics', path: '../lib/catalog/performance/metrics', extract: (m) => m.metrics },
      { name: 'utils', path: '../lib/catalog/utils', extract: (m) => m.utils },
    ];

    for (const imp of imports) {
      try {
        log(`‚è≥ Testando: ${imp.name} (${imp.path})...`, 'pending');

        const module = await import(imp.path);
        const extracted = imp.extract(module);

        if (extracted) {
          log(`‚úÖ ${imp.name}: OK (${typeof extracted})`, 'pass');
        } else {
          log(`‚ö†Ô∏è ${imp.name}: Import OK mas export n√£o encontrado`, 'fail');
        }
      } catch (error) {
        log(`‚ùå ${imp.name}: FALHOU!`, 'fail');
        log(`   Erro: ${error.message}`, 'fail');
        log(`   Stack: ${error.stack?.split('\n')[0]}`, 'fail');

        // Parar no primeiro erro para facilitar debug
        log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'fail');
        log('‚õî Teste parado no primeiro erro', 'fail');
        return;
      }
    }

    log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'pass');
    log('‚úÖ TODOS OS IMPORTS PASSARAM!', 'pass');
  }

  // Executar teste
  testImports().catch((error) => {
    log(`‚ùå ERRO FATAL: ${error.message}`, 'fail');
    console.error('Erro completo:', error);
  });
</script>
